GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  *=====================================================================================
   2  * Name:                 runvSPD.gms
   3  * Function:             This file is invoked to control the entire operation of vSPD.
   4  * Developed by:         Electricity Authority, New Zealand
   5  * Source:               https://github.com/ElectricityAuthority/vSPD
   6  *                       http://reports.ea.govt.nz/EMIIntro.htm
   7  * Contact:              emi@ea.govt.nz
   8  * Last modified on:     6 December 2013
   9  *=====================================================================================
  10   
  11   
  18   
  19   
  20  * Include paths and settings files
INCLUDE    Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDpaths.inc
  24   
  26   
  31   
  32   
INCLUDE    Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDsettings.inc
  37  *+++ vSPD settings +++
  40   
  41   
  42  *+++ Network +++
  43  Scalar useAClossModel                    / 1 / ;
  44  Scalar useHVDClossModel                  / 1 / ;
  45  Scalar useACbranchLimits                 / 1 / ;
  46  Scalar useHVDCbranchLimits               / 1 / ;
  47  Scalar resolveCircularBranchFlows        / 1 / ;
  48  Scalar resolveHVDCnonPhysicalLosses      / 1 / ;
  49  Scalar resolveACnonPhysicalLosses        / 0 / ;
  50  Scalar circularBranchFlowTolerance       / 0.000001 / ;
  51  Scalar nonPhysicalLossTolerance          / 0.000001 / ;
  52  Scalar useBranchFlowMIPTolerance         / 0.000001 / ;
  53   
  54   
  55  *+++ Constraints +++
  56  Scalar useReserveModel                   / 1 / ;
  57  Scalar suppressMixedConstraint           / 0 / ;
  58  Scalar mixedMIPtolerance                 / 0.000001 / ;
  59   
  60   
  61  *+++ Model and solver +++
  62  Scalar sequentialSolve                   / 0 / ;
  64  Scalar LPtimeLimit                       / 600 / ;
  65  Scalar LPiterationLimit                  / 1000000 / ;
  66  Scalar MIPtimeLimit                      / 600 / ;
  67  Scalar MIPoptimality                     / 0 / ;
  68  Scalar MIPiterationLimit                 / 1000000 / ;
  69   
  70   
  71  *+++ External loss model from Transpower +++
  72  Scalar useExternalLossModel              / 1 / ;
GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


  73  Scalar lossCoeff_A                       / 0.3101 / ;
  74  Scalar lossCoeff_C                       / 0.14495 / ;
  75  Scalar lossCoeff_D                       / 0.32247 / ;
  76  Scalar lossCoeff_E                       / 0.46742 / ;
  77  Scalar lossCoeff_F                       / 0.82247 / ;
  78  Scalar maxFlowSegment                    / 10000 / ;
  79   
  80   
  81  *+++ Misc +++
  82  Scalar disconnectedNodePriceCorrection   / 1 / ;
  84   
  85   
  86  *+++ Operating switches +++
  90  Scalar     opMode                        / 2 / ;   ! Specify 1 for data warehouse; -1 for audit; otherwise usual vSPD mode
  91  Scalar     tradePeriodReports            / 1 / ;   ! Specify 1 for reports at trading period level, 0 otherwise
  92   
  93   
  94  * Define external files
  95  Files
  96    temp       "A temporary, recyclable batch file"
  97    vSPDcase   "The current input case file"      / "vSPDcase.inc" /
  98    FTRrun     "Current FTR run type"             / "FTRrun.inc" /
  99    FTRdirect  "Current FTR direction"            / "FTRdirect.inc" / ;
 100   
 101    vSPDcase.lw = 0 ;   vSPDcase.sw = 0 ;
 102    FTRrun.lw = 0 ;     FTRrun.sw = 0 ;
 103    FTRdirect.lw = 0 ;  FTRdirect.sw = 0 ;
 104   
 105   
 106  *=====================================================================================
 107  * Perform integrity checks on operating modeand trade period reporting switches.
 108  *=====================================================================================
 109  * Notes: - Operating mode: 1 --> DW mode; -1 --> Audit mode; all else implies usual vSPD mode.
 110  *        - tradePeriodReports must be 0 or 1 (default = 1) - a value of 1 implies reports by trade
 111  *          period are generated. A value of zero will suppress them. tradePeriodReports must be 1
 112  *          if opMode is 1 or -1, i.e. data warehouse or audit modes.
 113  if(tradePeriodReports < 0 or tradePeriodReports > 1, tradePeriodReports = 1 ) ;
 115  if( (opMode = -1) or (opMode = 1), tradePeriodReports = 1 ) ;
 116  *Display opMode, tradePeriodReports ;
 117   
 118   
 119   
 120  *=====================================================================================
 121  * Install the set of input GDX file names over which the solve and reporting loops will operate
 122  *=====================================================================================
 123  Set i_fileName 'Input GDX file names'
INCLUDE    Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDfileList.inc
 125  /
 126  FP_201303111516
 127  /
 128    ;
 129   
 130   
GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 131   
 132  *=====================================================================================
 133  * FTR rental data preparation
 134  *=====================================================================================
 135   
 136  * Set FTR flag to zero for normal vSPD run
 137  Scalar FTRflag  / 0 / ;
 138  putclose FTRrun "Scalar FTRflag  / 0 / ;"
 139   
 141   
 142   
 143   
 144  *=====================================================================================
 145  * Solve vSPD - loop over the designated input GDX files and solve each one in turn.
 146  *=====================================================================================
 147   
 148  * Call runvSPDsetup to establish the output folders etc for the current job
 149  put_utility temp 'exec' / 'gams runvSPDsetup' ;
 150   
 151  Scalar runNum 'Scalar to keep track of the run number' / 1 / ;
 152  loop(i_fileName,
 153   
 154  * Create the file that has the name of the input file for the current case being solved
 155    putclose vSPDcase "$setglobal  vSPDinputData  " i_fileName.tl:0 / "$setglobal  vSPDrunNum     " runNum:0:0 ;
 156   
 157  * Solve the model for the current input file
 158    put_utility temp 'exec' / 'gams runvSPDsolve' ;
 159   
 160  * Copy the vSPDsolve.lst file to i_fileName.lst in ..\Programs\lst\
 161    put_utility temp 'shell' / 'copy vSPDsolve.lst "Z:\home\nigel\python\vSPDReservePivotal\Programs\"\lst\', i_fileName.tl:0, '.lst' ;
 162   
 164   
 165  * Increment the run number before going around loop again
 166    runNum = runNum + 1 ;
 167   
 168  ) ;
 169   
 170   
 171  *=====================================================================================
 172  * Generate reports (solving vSPD is now finished).
 173  *=====================================================================================
 174   
 175  if( (FTRflag = 0),
 176  * Do the usual vSPD reporting
 177   
 178  * Call vSPDreportSetup to establish the report files ready to write results into
 179    put_utility temp 'exec' / 'gams runvSPDreportSetup' ;
 180   
 181  * Loop over the designated input files and generate vSPD reports
 182    runNum = 1 ;
 183    loop(i_fileName,
 184   
 185  *     Create file that has the name of the input file for the current case being reported on
GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 186        putclose vSPDcase "$setglobal  vSPDinputData  " i_fileName.tl:0 / "$setglobal  vSPDrunNum     " runNum:0:0 ;
 187   
 188  *     Generate the reports
 189        put_utility temp 'exec' / 'gams runvSPDreport';
 190   
 191  *     Remove the temporary output GDX files
 192        put_utility temp 'shell' / 'del "Z:\home\nigel\python\vSPDReservePivotal\Programs\..\Output\SinglePer\runNum'runNum:0:0'_*.gdx"' ;
 193   
 194  *     Increment the run number before going around loop again
 195        runNum = runNum + 1 ;
 196   
 197    ) ;
 198   
 199  elseif (FTRflag = 1),
 200  * Do the FTR calculations and reporting in the case where FTR rents are being calculated
 201   
 202  * Call setup file
 203    put_utility temp 'exec' / 'gams FTRreportSetup errmsg=1';
 204   
 205  * Reset the run num
 206    runNum = 1;
 207   
 208  * Loop over all the specified files and run the model
 209    loop(i_FileName,
 210   
 211  *   Create file that has the current case input file being solved
 212      putclose vSPDcase "$setglobal  VSPDInputData  " i_Filename.tl:0 / "$setglobal  VSPDRunNum  " runNum:0:0;
 213   
 214  *   Run the model
 215      put_utility temp 'exec' / 'gams FTRrentalCalculation errmsg=1';
 216   
 217  *   Remove the temporary output GDX files
 218      put_utility temp 'shell' / 'del "Z:\home\nigel\python\vSPDReservePivotal\Programs\..\Output\SinglePer\runNum'runNum:0:0'_*.gdx"' ;
 219   
 220  *   Increment the run number before going around loop again
 221      runNum = runNum + 1 ;
 222   
 223    ) ;
 224   
 225  * Remove the temporary output GDX files
 226    put_utility temp 'shell' / 'del "Z:\home\nigel\python\vSPDReservePivotal\Programs\..\Output\SinglePer\FTRflow.gdx"' ;
 227   
 228  ) ;
 229   
 230   
 231   
 232  *=====================================================================================
 233  * Clean up
 234  *=====================================================================================
 236  execute 'del "*.lst"' ;
 237  execute 'del "*.~gm"' ;
 238  execute 'del "*.lxi"' ;
 239  execute 'del "*.log"' ;
GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 240  execute 'del "*.put"' ;
 241  execute 'del "*.txt"' ;
GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  Z:\home\nigel\python\vSPDReservePivotal\Programs\runvSPD.gms
     2       12 CALL           1      12  cls
     3       21 INCLUDE        1      21  .Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDpaths.inc
     4       36 INCLUDE        1      22  .Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDsettings.inc
     5      124 INCLUDE        1      55  .Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDfileList.inc


COMPILATION TIME     =        0.256 SECONDS      3 Mb  WEX240-240 Feb 14, 2013
GAMS Rev 240  WEX-WEI 24.0.2 x86_64/MS Windows                                                                                                                                                                                         03/12/14 14:41:36 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


**** REPORT FILE SUMMARY

temp Z:\home\nigel\python\vSPDReservePivotal\Programs\temp.put
vSPDcase Z:\home\nigel\python\vSPDReservePivotal\Programs\vSPDcase.inc
FTRrun Z:\home\nigel\python\vSPDReservePivotal\Programs\FTRrun.inc


EXECUTION TIME       =       10.991 SECONDS      4 Mb  WEX240-240 Feb 14, 2013


USER: Lynda Clements                                 G120423:0647AN-WIN
      The University of Auckland                                 DC9645
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      Z:\home\nigel\python\vSPDReservePivotal\Programs\runvSPD.gms
Output     Z:\home\nigel\python\vSPDReservePivotal\Programs\runvSPD.lst
